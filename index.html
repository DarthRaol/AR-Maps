<!DOCTYPE html>
<html>
<head>
	<meta charset='utf-8' />
	<title>User Location</title>
	<meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
	<link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">


	<script src="https://api.mapbox.com/mapbox-gl-js/v1.9.1/mapbox-gl.js"></script>
	<link href="https://api.mapbox.com/mapbox-gl-js/v1.9.1/mapbox-gl.css" rel="stylesheet" />
	<style>
		body { margin:0; padding:0; }
		#map { position:absolute; top:0; bottom:0; width:100%;}
	</style>
</head>
<body>
	<style>
		.marker {
            display: block;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            padding: 0;
        }
	</style>

	<!--  the map -->
	<div id='map'></div>
	<!-- left side instructions -->
	


	<script>


		mapboxgl.accessToken = 'pk.eyJ1IjoiZmFraHIiLCJhIjoiY2pseXc0djE0MHBibzN2b2h4MzVoZjk4aSJ9.ImbyLtfsfSsR_yyBluR8yQ';

        const map = new mapboxgl.Map({
            container: 'map', // container id
            style: 'mapbox://styles/mapbox/streets-v9', //hosted style id
            center: [0, 0], // starting position
            zoom: 15, // starting zoom
            minZoom: 11 // keep it local
        });

        if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(
            (position) => {
            var currentUserLocation = [position.coords.longitude, position.coords.latitude];

            map.flyTo({
            center: currentUserLocation,
            essential: true, // Ensures smooth camera transition
            zoom: 15,
            });            

            console.log(currentUserLocation);

        })};

        

        const el = document.createElement('div');
        el.className = 'marker';
        el.style.backgroundImage = `url(img/currentLocation.png)`;
        el.style.width = `60px`;
        el.style.height = `60px`;
        el.style.backgroundSize = '100%';
        //make a marker for each feature and add to the map
        const currentUserMarker = new mapboxgl.Marker(el)
        .setLngLat([0, 0])
        .addTo(map);
            
        const carterRoadMarker = new mapboxgl.Marker()
        .setLngLat([72.8227068091439, 19.067521764462125]) // Marker in carter road
        .addTo(map);

        const mountMaryMarker = new mapboxgl.Marker()
        .setLngLat([72.82241889786202, 19.046617401768984]) // Marker in Mount Mary
        .addTo(map);

        const linkingRoadMarker = new mapboxgl.Marker()
        .setLngLat([72.83426278234403, 19.074857618070297]) // Marker in linking road
        .addTo(map);

        const waterfieldMarker = new mapboxgl.Marker()
        .setLngLat([72.83427634002794, 19.060074213863803]) // Marker in carter road
        .addTo(map);

        GetUserLocation();

        function GetUserLocation(){
            // do whatever you like here

            if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(
                (position) => {
                var currentUserLocation = [position.coords.longitude, position.coords.latitude];

                map.flyTo({
                center: currentUserLocation,
                essential: true, // Ensures smooth camera transition
                zoom: 15,
                });            
                currentUserMarker.setLngLat(currentUserLocation);

            })};

            setTimeout(GetUserLocation, 5000);
        }

    </script>

</body>
</html>